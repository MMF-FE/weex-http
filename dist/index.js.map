{"version":3,"sources":["webpack:///webpack/bootstrap dbde85f69d52f0c4f30c","webpack:///./src/index.ts","webpack:///./src/util.ts"],"names":[],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,mCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,gCAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,MAAK;AACL;AACA;AACA,cAAa,6BAA6B,0BAA0B,aAAa,EAAE,qBAAqB;AACxG,iBAAgB,qDAAqD,oEAAoE,aAAa,EAAE;AACxJ,uBAAsB,sBAAsB,qBAAqB,GAAG;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC;AACvC,mCAAkC,SAAS;AAC3C,mCAAkC,WAAW,UAAU;AACvD,0CAAyC,cAAc;AACvD;AACA,8GAA6G,OAAO,UAAU;AAC9H,iFAAgF,iBAAiB,OAAO;AACxG,yDAAwD,gBAAgB,QAAQ,OAAO;AACvF,+CAA8C,gBAAgB,gBAAgB,OAAO;AACrF;AACA,kCAAiC;AACjC;AACA;AACA,UAAS,YAAY,aAAa,OAAO,EAAE,UAAU,WAAW;AAChE,oCAAmC,SAAS;AAC5C;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA,qBAAoB;AACpB;AACA,oCAAmC,EAAE;AACrC;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC,kCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA,sCAAqC;AACrC;AACA,8BAA6B,4BAA4B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC;AACjC,8BAA6B,EAAE,EAAE;AACjC;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA,+BAA8B,WAAW;AACzC,kCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,WAAW;AACjD;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;;;;;;;ACnUA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B,cAAc;AAC3C,kCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dbde85f69d52f0c4f30c","/**\n * http lib\n * @author vfasky<vfasky@gmail.com>\n *\n **/\n'use strict';\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar stream = weex.requireModule('stream');\nvar methods = ['GET', 'DELETE', 'HEAD', 'POST', 'PUT', 'PATCH'];\nvar buildUrlMemthods = ['POST', 'PUT', 'PATCH'];\nvar platform = weex.config.env.platform.toLocaleLowerCase();\nvar is = {\n    web: platform === 'web',\n    android: platform === 'android',\n    iOS: platform === 'ios',\n    ios: platform === 'ios',\n    wechat: platform === 'web' && (/micromessenger/i).test(navigator.userAgent)\n};\nvar Http = (function () {\n    function Http(options) {\n        this.options = util_1.setOptonsDefault(options, {\n            timeout: 10000,\n            headers: {},\n            baseURL: '',\n            method: 'GET',\n            data: {},\n            url: '/',\n            progress: function () { },\n            transformRequest: [],\n            transformResponse: [],\n            transformHeaders: []\n        });\n    }\n    Http.prototype.getHeaders = function () {\n        return this.clone(util_1.setOptonsDefault(this.options.headers, {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }));\n    };\n    Http.prototype.getMethod = function (options) {\n        var method = String(options.method).trim().toLocaleUpperCase();\n        if (methods.indexOf(method) === -1) {\n            throw new Error(method + \" not in \" + methods.join(', '));\n        }\n        return method;\n    };\n    Http.prototype.buildUrl = function (options) {\n        return (options.hasOwnProperty('baseURL') ? options.baseURL : this.options.baseURL) +\n            options.url;\n    };\n    Http.prototype.clone = function (data) {\n        return JSON.parse(JSON.stringify(data));\n    };\n    Http.prototype.buildData = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, sendData;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        data = this.clone(options.data);\n                        return [4 /*yield*/, this.callPromise('transformRequest', options, data)];\n                    case 1:\n                        _a.sent();\n                        sendData = util_1.param(data);\n                        return [2 /*return*/, sendData];\n                }\n            });\n        });\n    };\n    Http.prototype.callPromise = function (funStr, options, data) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!Array.isArray(this.options[funStr])) return [3 /*break*/, 2];\n                        return [4 /*yield*/, Promise.all(this.options[funStr].map(function (promise) {\n                                return promise(data);\n                            }))];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        if (!Array.isArray(options[funStr])) return [3 /*break*/, 4];\n                        return [4 /*yield*/, Promise.all(options[funStr].map(function (promise) {\n                                return promise(data);\n                            }))];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4: return [2 /*return*/, data];\n                }\n            });\n        });\n    };\n    Http.prototype.send = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var timeout, method, body, url, headers, isSend, link;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        timeout = options.hasOwnProperty('timeout') ? options.timeout : this.options.timeout;\n                        method = this.getMethod(options);\n                        return [4 /*yield*/, this.buildData(options)];\n                    case 1:\n                        body = _a.sent();\n                        url = this.buildUrl(options);\n                        headers = this.getHeaders();\n                        if (options.headers) {\n                            Object.keys(options.headers).forEach(function (key) {\n                                headers[key] = options.headers[key];\n                            });\n                        }\n                        return [4 /*yield*/, this.callPromise('transformHeaders', options, headers)];\n                    case 2:\n                        _a.sent();\n                        isSend = true;\n                        if (buildUrlMemthods.indexOf(method.toLocaleUpperCase()) === -1) {\n                            link = url.indexOf('?') === -1 ? '?' : '&';\n                            url += link + body;\n                            body = '';\n                            isSend = false;\n                        }\n                        return [2 /*return*/, new Promise(function (resolve, reject) {\n                                var isReturn = false;\n                                var timeoutId = setTimeout(function () {\n                                    isReturn = true;\n                                    reject({\n                                        status: 0,\n                                        ok: false,\n                                        statusText: 'TIMEOUT',\n                                        data: 'TIMEOUT',\n                                        headers: {}\n                                    });\n                                }, timeout);\n                                // ios8 wechat back bug\n                                if (is.wechat) {\n                                    var deviceAgent = navigator.userAgent.toLowerCase();\n                                    var isIos8_1 = /(iphone|ipod|ipad).* os 8_/.test(deviceAgent);\n                                    var xhr_1 = new XMLHttpRequest();\n                                    var xhrDone_1 = function () {\n                                        clearTimeout(timeoutId);\n                                        if (isReturn)\n                                            return;\n                                        if (xhr_1.status >= 200 && xhr_1.status < 300) {\n                                            resolve({\n                                                status: xhr_1.status,\n                                                ok: true,\n                                                statusText: xhr_1.statusText,\n                                                data: xhr_1.responseText,\n                                                headers: {}\n                                            });\n                                        }\n                                    };\n                                    var xhrOnChange = function () {\n                                        if (xhr_1.readyState == 4) {\n                                            // 微信你大爷\n                                            if (!xhr_1.status && isIos8_1) {\n                                                var key = '__weex_http';\n                                                var lastReloadDate = localStorage.getItem(key);\n                                                var now = Date.now();\n                                                if (lastReloadDate == null || now - Number(lastReloadDate) > 5000) {\n                                                    localStorage.setItem(key, String(now));\n                                                    window.location.reload();\n                                                }\n                                                return;\n                                            }\n                                            xhrDone_1();\n                                        }\n                                    };\n                                    xhr_1.onreadystatechange = xhrOnChange;\n                                    xhr_1.open(method, url, true);\n                                    Object.keys(headers).forEach(function (key) {\n                                        xhr_1.setRequestHeader(key, headers[key]);\n                                    });\n                                    xhr_1.send(body);\n                                }\n                                else {\n                                    stream.fetch({\n                                        method: method,\n                                        body: body,\n                                        url: url,\n                                        headers: headers,\n                                        type: 'text'\n                                    }, function (response) {\n                                        clearTimeout(timeoutId);\n                                        if (isReturn)\n                                            return;\n                                        if (response.ok) {\n                                            resolve(response);\n                                        }\n                                        else {\n                                            reject(response);\n                                        }\n                                    }, function (args) {\n                                        _this.options.progress(args);\n                                    });\n                                }\n                            }).then(function (response) { return __awaiter(_this, void 0, void 0, function () {\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4 /*yield*/, this.callPromise('transformResponse', options, response)];\n                                        case 1:\n                                            _a.sent();\n                                            return [2 /*return*/, response];\n                                    }\n                                });\n                            }); })];\n                }\n            });\n        });\n    };\n    Object.defineProperty(Http, \"config\", {\n        get: function () {\n            return this._config;\n        },\n        set: function (options) {\n            var _this = this;\n            Object.keys(options).forEach(function (key) {\n                _this._config[key] = options[key];\n                if (_this._instance) {\n                    _this._instance.options[key] = options[key];\n                }\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Http.buildMethod = function (method, url, data, options, instance) {\n        if (data === void 0) { data = {}; }\n        if (options === void 0) { options = {}; }\n        if (!instance) {\n            if (!this._instance) {\n                this._instance = new this(this.config);\n            }\n            instance = this._instance;\n        }\n        options.method = method;\n        options.data = data;\n        options.url = url;\n        return instance.send(options);\n    };\n    Http.create = function (options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var instance = new this(options);\n        var func = {\n            instance: instance\n        };\n        methods.forEach(function (method) {\n            func[method.toLocaleLowerCase()] = function (url, data, options) {\n                if (data === void 0) { data = {}; }\n                return _this.buildMethod(method, url, data, options, instance);\n            };\n        });\n        return func;\n    };\n    Http.get = function (url, data, options) {\n        if (data === void 0) { data = {}; }\n        return this.buildMethod('GET', url, data, options);\n    };\n    Http.post = function (url, data, options) {\n        if (data === void 0) { data = {}; }\n        return this.buildMethod('POST', url, data, options);\n    };\n    Http.delete = function (url, data, options) {\n        if (data === void 0) { data = {}; }\n        return this.buildMethod('DELETE', url, data, options);\n    };\n    Http.head = function (url, data, options) {\n        if (data === void 0) { data = {}; }\n        return this.buildMethod('HEAD', url, data, options);\n    };\n    Http.put = function (url, data, options) {\n        if (data === void 0) { data = {}; }\n        return this.buildMethod('PUT', url, data, options);\n    };\n    Http.patch = function (url, data, options) {\n        if (data === void 0) { data = {}; }\n        return this.buildMethod('PATCH', url, data, options);\n    };\n    return Http;\n}());\nHttp._config = {\n    timeout: 10000,\n    baseURL: '',\n    headers: {}\n};\nexports.default = Http;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.ts\n// module id = 0\n// module chunks = 0","/**\n * util\n * @author vfasky<vfasky@gmail.com>\n *\n **/\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar rbracket = /\\[\\]$/;\nfunction buildParams(prefix, obj, add) {\n    var name;\n    if (Array.isArray(obj)) {\n        // Serialize array item.\n        obj.forEach(function (v, i) {\n            if (rbracket.test(prefix)) {\n                // Treat each array item as a scalar.\n                add(prefix, v);\n            }\n            else {\n                // Item is non-scalar (array or object), encode its numeric index.\n                buildParams(prefix + \"[\" + (typeof v === \"object\" && v != null ? i : \"\") + \"]\", v, add);\n            }\n        });\n    }\n    else if (typeof obj === \"object\") {\n        // Serialize object item.\n        for (name in obj) {\n            buildParams(prefix + \"[\" + name + \"]\", obj[name], add);\n        }\n    }\n    else {\n        // Serialize scalar item.\n        add(prefix, obj);\n    }\n}\nfunction setOptonsDefault(options, defaultVals) {\n    if (options === void 0) { options = {}; }\n    if (defaultVals === void 0) { defaultVals = {}; }\n    Object.keys(defaultVals).forEach(function (key) {\n        if (!options.hasOwnProperty(key)) {\n            options[key] = defaultVals[key];\n        }\n    });\n    return options;\n}\nexports.setOptonsDefault = setOptonsDefault;\nfunction isFunction(obj) {\n    return !!(obj && obj.constructor && obj.call && obj.apply);\n}\nexports.isFunction = isFunction;\nfunction param(a) {\n    if (a === void 0) { a = {}; }\n    var prefix;\n    var s = [];\n    var add = function (key, valueOrFunction) {\n        // If value is a function, invoke it and use its return value\n        var value = isFunction(valueOrFunction) ? valueOrFunction() : valueOrFunction;\n        s[s.length] = encodeURIComponent(key) + \"=\" + encodeURIComponent(value == null ? \"\" : value);\n    };\n    for (prefix in a) {\n        buildParams(prefix, a[prefix], add);\n    }\n    // Return the resulting serialization\n    return s.join(\"&\");\n}\nexports.param = param;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/util.ts\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}